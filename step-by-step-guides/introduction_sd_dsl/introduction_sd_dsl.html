<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.267">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>BPTK_PY – introduction_sd_dsl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../sd-dsl/in-depth/in_depth_simple_python_library_sd_dsl/in_depth_simple_python_library_sd_dsl.html" rel="next">
<link href="../../sd-dsl/sddsl.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">BPTK_PY</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">BPTK_PY</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../usage/installation.html" class="sidebar-item-text sidebar-link">Installation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../usage/quickstart.html" class="sidebar-item-text sidebar-link">Quickstart</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../usage/limitations.html" class="sidebar-item-text sidebar-link">Limitations</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../general/general.html" class="sidebar-item-text sidebar-link">General Information</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../general/in-depth/in_depth_bptk_py_architecture/in_depth_bptk_py_architecture.html" class="sidebar-item-text sidebar-link">Architecture</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../general/in-depth/in_depth_scenarios/in_depth_scenarios.html" class="sidebar-item-text sidebar-link">Scenarios in Depth</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../general/how-to/how_to_accessing_raw_simulation_results/how_to_accessing_raw_simulation_results.html" class="sidebar-item-text sidebar-link">Accessing Raw Simulation Results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../general/how-to/how_to_advanced_plotting_features/how_to_advanced_plotting_features.html" class="sidebar-item-text sidebar-link">Advanced Plotting Features</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../general/how-to/how_to_develop_dashboards_using_jupyter_widgets/how_to_developing_dashboards_using_juypter_widgets.html" class="sidebar-item-text sidebar-link">Dashboards using Jupyter Widgets</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../general/how-to/how_to_develop_dashboards_using_simpledashboard/how_to_develop_dashboards_using_simpledashboard.html" class="sidebar-item-text sidebar-link">Dashboards using the SimpleDashboard</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../general/how-to/how_to_external_state/how_to_external_state.html" class="sidebar-item-text sidebar-link">Persistent BPTK-Server State</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../abm/abm.html" class="sidebar-item-text sidebar-link">Agent Based Modeling</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../abm/in-depth/in_depth_agent_based_modeling/in_depth_agent_based_modeling.html" class="sidebar-item-text sidebar-link">Agent Based Modeling</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../abm/how-to/how_to_choose_datacollector/how_to_choose_datacollector.html" class="sidebar-item-text sidebar-link">Data Collector</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../xmile/xmile.html" class="sidebar-item-text sidebar-link">Introduction to XMILE</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../xmile/how-to/how_to_working_with_XMILE/how_to_working_with_XMILE.html" class="sidebar-item-text sidebar-link">XMILE SD Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../xmile/how-to/how_to_exporting_simulation_results/how_to_exporting_simulation_results.html" class="sidebar-item-text sidebar-link">Exporting Simulation Results</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../xmile/how-to/how_to_xmile_arrays/how_to_xmile_arrays.html" class="sidebar-item-text sidebar-link">Arrayed Variables in XMILE Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../xmile/how-to/how_to_use_sd_compiler_standalone/how_to_use_sd_compiler_standalone.html" class="sidebar-item-text sidebar-link">Use Standalone XMILE Compiler</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../xmile/in-depth/writing_computational_essays/writing_computational_essays.html" class="sidebar-item-text sidebar-link">Writing Computational Essays</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../sd-dsl/sddsl.html" class="sidebar-item-text sidebar-link">Introduction to SD DSL</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../step-by-step-guides/introduction_sd_dsl/introduction_sd_dsl.html" class="sidebar-item-text sidebar-link active">Introduction to SD DSL</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../sd-dsl/in-depth/in_depth_simple_python_library_sd_dsl/in_depth_simple_python_library_sd_dsl.html" class="sidebar-item-text sidebar-link">BPTK for System Dynamics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../sd-dsl/in-depth/in_depth_sd_dsl_functions/in_depth_sd_dsl_functions.html" class="sidebar-item-text sidebar-link">SD DSL Functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../sd-dsl/how-to/how_to_sd_user_defined_functions/how_to_sd_user_defined_functions.html" class="sidebar-item-text sidebar-link">User-defined functions</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-into-system-dynamics-using-python" id="toc-introduction-into-system-dynamics-using-python" class="nav-link active" data-scroll-target="#introduction-into-system-dynamics-using-python">Introduction into System Dynamics using Python</a>
  <ul class="collapse">
  <li><a href="#stocks" id="toc-stocks" class="nav-link" data-scroll-target="#stocks">Stocks</a></li>
  <li><a href="#flows" id="toc-flows" class="nav-link" data-scroll-target="#flows">Flows</a></li>
  <li><a href="#equations" id="toc-equations" class="nav-link" data-scroll-target="#equations">Equations</a></li>
  <li><a href="#converters" id="toc-converters" class="nav-link" data-scroll-target="#converters">Converters</a></li>
  <li><a href="#connectors" id="toc-connectors" class="nav-link" data-scroll-target="#connectors">Connectors</a></li>
  <li><a href="#scenarios" id="toc-scenarios" class="nav-link" data-scroll-target="#scenarios">Scenarios</a></li>
  <li><a href="#export-data-as-dataframe" id="toc-export-data-as-dataframe" class="nav-link" data-scroll-target="#export-data-as-dataframe">Export data as “DataFrame”</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="introduction-into-system-dynamics-using-python" class="level1">
<h1>Introduction into System Dynamics using Python</h1>
<p>System dynamics is a method devoted to the study of systems, and is thus a tool within the Systems Thinking tool kit. It uses simple graphical notations to model systems such as stock and flow diagrams. These diagrams contain specific components and symbols to describe systems. This tutorial gives an introduction to the elemens of stock and flow diagram using the BPTK-Py framework.</p>
<p>The tutorial explains system dynamics with a population model. The model shows how the population changes overtime and which factors influence the population value.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/population.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image</figcaption><p></p>
</figure>
</div>
<p>Now, let’s create the model. It is used to store all stocks, converters and flows. The model runs for 10 years (starttime = 0, stoptime = 10) and we want to analyse the results after each year (dt = 1). In the next steps we are going to add the stocks and flows to the model.</p>
<p>We want to simulate how the population changes in the next ten years under external influences.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> BPTK_Py <span class="im">import</span> Model</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> BPTK_Py <span class="im">import</span> sd_functions <span class="im">as</span> sd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Model(starttime<span class="op">=</span><span class="fl">1.0</span>,stoptime<span class="op">=</span><span class="fl">10.0</span>,dt<span class="op">=</span><span class="fl">1.0</span>,name<span class="op">=</span><span class="st">'Population'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="stocks" class="level3">
<h3 class="anchored" data-anchor-id="stocks">Stocks</h3>
<p>A stock represents a part of a system whose value at any given instant in time depends on the systems past behavior. The value of the stocks at a particular instant in time cannot simply be determined by measuring the value of the other parts of the system at that instant in time – the only way you can calculate it is by measuring how it changes at every instant and adding up all these changes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/stock_population.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image</figcaption><p></p>
</figure>
</div>
<p>The stock in our model represents the population at each timestep. Initially, we assume 80 mio. people living in our fictional country. We create a model by entering <code>model.stock(&lt;name&gt;)</code>. The name of our stock is “population”.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> model.stock(<span class="st">"population"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>population.initial_value <span class="op">=</span> <span class="fl">80000000.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>population.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-4-output-1.png" width="1593" height="786"></p>
</div>
</div>
<p>The population does not change. There are no other factors influencing the number of people. To simulate changes in the population, we need births and deaths. We add these factors by using flows.</p>
</section>
<section id="flows" class="level3">
<h3 class="anchored" data-anchor-id="flows">Flows</h3>
<p>Flows represent the rate at which the stock is changing at any given timestep. They either flow into a stock (causing it to increase) or flow out of a stock (causing it to decrease).</p>
<p><img src="./images/flow_births.png" class="img-fluid" alt="Image"> <img src="./images/flow_deaths.png" class="img-fluid" alt="Image"></p>
<p>Let us make this model simple and just suppose 1,000,000 babies are born and 2,000,000 people die each year. The flows are defined by using the method <code>model.flow(&lt;name&gt;)</code>.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>births <span class="op">=</span> model.flow(<span class="st">"births"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>deaths <span class="op">=</span> model.flow(<span class="st">"deaths"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>births.equation <span class="op">=</span> <span class="fl">1000000.0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>deaths.equation <span class="op">=</span> <span class="fl">2000000.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>births.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-6-output-1.png" width="1584" height="786"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>deaths.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-7-output-1.png" width="1584" height="786"></p>
</div>
</div>
</section>
<section id="equations" class="level3">
<h3 class="anchored" data-anchor-id="equations">Equations</h3>
<p>To connect elements we require equations. These are mathematical operations that are evaluated at each timestep. We combine the flows with our stock by setting the <code>equation</code> field of <code>population</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/stock_flow_population.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image</figcaption><p></p>
</figure>
</div>
<p>In our simple example, the population is the sum of births minus the deaths plus the initial value or the value from the last timestep.</p>
<p>The Logic in System Dynamics is always the same: Values at timestep <code>t</code> depend on the result at <code>t-1</code> Let us look at the population:</p>
<pre><code>
population.equation = births - deaths

population (1)  = 80,000,0000 (start time)
population (2) = population(1) + (births(2) - deaths(2)) = 80,000,000 + (1,000,000 - 2,000,000) = 79,000,000
population (3) = population(2) + (births(2) - deaths(2)) = 79,000,000 + (1,000,000 - 2,000,000) = 78,000,000

and so on...</code></pre>
<p>See how easy it is to define this behavior:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>population.equation <span class="op">=</span> births <span class="op">-</span> deaths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And let’s check whether we are able to obtain the expected results:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"population(1): "</span> <span class="op">+</span> <span class="bu">str</span>(population(<span class="dv">1</span>)))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"population(2): "</span> <span class="op">+</span> <span class="bu">str</span>(population(<span class="dv">2</span>)))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"population(3): "</span> <span class="op">+</span> <span class="bu">str</span>(population(<span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>population(1): 80000000.0
population(2): 79000000.0
population(3): 78000000.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>population.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-10-output-1.png" width="1593" height="786"></p>
</div>
</div>
<p>In reality, the number of births or deaths is not fixed, we usually work with ratios. They change depending on the population and external factors (diseases, medical supply, food supply etc.). In system dynamics, we model such behavior with converters.</p>
</section>
<section id="converters" class="level3">
<h3 class="anchored" data-anchor-id="converters">Converters</h3>
<p>Converters either represent parts at the boundary of the system (i.e.&nbsp;parts whose value is not determined by the behavior of the system itself) or they represent parts of a system whose value can be derived from other parts of the system at any time through some computational procedure.</p>
<p>Let us model the following model in Python</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/population.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Image</figcaption><p></p>
</figure>
</div>
<p>In the image above, the converters are represented by circles. In Python, we define converters with <code>model.converter</code> or <code>model.constant</code>. <code>constants</code> are converters with a constant value (i.e.&nbsp;they never change).</p>
<p>We want to model the birth rate and death rate that are influenced by the food supply.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>birthRate <span class="op">=</span> model.converter(<span class="st">"birthRate"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>deathRate <span class="op">=</span> model.converter(<span class="st">"deathRate"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>foodAvailablePerPerson <span class="op">=</span> model.converter(<span class="st">"foodAvailablePerPerson"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>foodAvailable <span class="op">=</span> model.constant(<span class="st">"foodAvailable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="connectors" class="level3">
<h3 class="anchored" data-anchor-id="connectors">Connectors</h3>
<p>Much like in causal loop diagrams the connectors of a system show how the parts of a system influence each other. Stocks can only be influenced by flows (i.e.&nbsp;there can be no connector that connects into a stock), flows can be influenced by stocks, other flows, and by converters. Converters either are not influenced at all (i.e.&nbsp;they are at the systems boundary) or are influenced by stocks, flows and other converters.</p>
<p>Please note that we do not explicitly model connectors but create the connection by defining equations. Equations are expressive enough to represent interactions between model elements.</p>
<p>Since <code>foodAvailable</code> is a constant, we can initiliaze it with a float value.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>foodAvailable.equation <span class="op">=</span> <span class="fl">80000000.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The converters <code>foodAvailablePerPerson</code> and <code>birthRate</code> are formulas. <code>foodAvailablePerPerson</code> depends on <code>population</code> and <code>foodAvailable</code>. The more people the less food per person. The birth rate decreases if we have less than one unit food per person.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>foodAvailablePerPerson.equation <span class="op">=</span> foodAvailable <span class="op">/</span> population</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>birthRate.equation <span class="op">=</span> <span class="fl">0.01</span> <span class="op">*</span> foodAvailablePerPerson</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>births.equation <span class="op">=</span> birthRate <span class="op">*</span> population</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We define the death rate in our model using a non-linear relationship (depending on food available per person). We capture this relationship in a lookup table (often also called “graphical function” in the System Dynamics context) that we store in the <code>points</code> property of the model (using a Python list).</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model.points[<span class="st">"deathRate"</span>] <span class="op">=</span> [</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.0</span>,<span class="fl">1.0</span>],</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.1</span>,<span class="fl">0.670320046036</span>],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.2</span>,<span class="fl">0.449328964117</span>],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.3</span>,<span class="fl">0.301194211912</span>],</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.4</span>,<span class="fl">0.201896517995</span>],</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.5</span>,<span class="fl">0.135335283237</span>],</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.6</span>,<span class="fl">0.0907179532894</span>],</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.7</span>,<span class="fl">0.0608100626252</span>],</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.8</span>,<span class="fl">0.0407622039784</span>],</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">0.9</span>,<span class="fl">0.025</span>],</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    [<span class="fl">1.0</span>,<span class="fl">0.01</span>]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>deaths.equation <span class="op">=</span> deathRate <span class="op">*</span> population</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can easily plot the lookup table to see whether it has the right shape:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model.plot_lookup(<span class="st">"deathRate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-15-output-1.png" width="1546" height="786"></p>
</div>
</div>
<p>We now need to connect the <code>deathRate</code> lookup to the <code>foodAvailablePerPopulation</code>:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>deathRate.equation <span class="op">=</span> sd.lookup(foodAvailablePerPerson, <span class="st">"deathRate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we have defined all components. Let us plot them. We first register the model.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> BPTK_Py</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>bptk <span class="op">=</span> BPTK_Py.bptk()</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>bptk.register_model(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>bptk.plot_scenarios(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    scenarios<span class="op">=</span><span class="st">"base"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    scenario_managers<span class="op">=</span><span class="st">"smPopulation"</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    equations<span class="op">=</span>[<span class="st">"population"</span>,<span class="st">"deaths"</span>,<span class="st">"births"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'foodAvailable': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769310&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769700&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7698B0&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7699D0&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769A60&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769B80&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769CA0&gt;}</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-18-output-2.png" width="1631" height="812"></p>
</div>
</div>
<p>With these settings the population is stable, because birth rate and death rate are equal.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>bptk.plot_scenarios(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    scenarios<span class="op">=</span>[<span class="st">"base"</span>],</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    scenario_managers<span class="op">=</span><span class="st">"smPopulation"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    equations<span class="op">=</span>[<span class="st">"birthRate"</span>,<span class="st">"deathRate"</span>],</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    series_names<span class="op">=</span>{}</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'foodAvailable': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769310&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769700&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7698B0&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7699D0&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769A60&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769B80&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769CA0&gt;}</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-19-output-2.png" width="1561" height="812"></p>
</div>
</div>
</section>
<section id="scenarios" class="level3">
<h3 class="anchored" data-anchor-id="scenarios">Scenarios</h3>
<p>BPTK Py creates a scenario <code>base</code> by default when registering the model. However, it is boring just to examine one scenario. We want to make various assumptions to understand the behavior of the model or the system. Changing values can lead to different outcomes. For this purpose, the BPTK Py framework provides a powerful scenario management enabling us to create different scenarios.</p>
<p>We set up a scenario manager using a Python dictionary. The scenario manager identifies the baseline constants of the model:</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>scenario_manager <span class="op">=</span> {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"smPopulation"</span>:{</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: model,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"base_constants"</span>: {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"population"</span>: <span class="fl">80000000.0</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"foodAvailable"</span>: <span class="fl">80000000.0</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"base_points"</span>:{</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"deathRate"</span>: [</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.0</span>,<span class="fl">1.0</span>],</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.1</span>,<span class="fl">0.670320046036</span>],</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.2</span>,<span class="fl">0.449328964117</span>],</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.3</span>,<span class="fl">0.301194211912</span>],</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.4</span>,<span class="fl">0.201896517995</span>],</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.5</span>,<span class="fl">0.135335283237</span>],</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.6</span>,<span class="fl">0.0907179532894</span>],</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.7</span>,<span class="fl">0.0608100626252</span>],</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.8</span>,<span class="fl">0.0407622039784</span>],</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">0.9</span>,<span class="fl">0.0273237224473</span>],</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>            [<span class="fl">1.0</span>,<span class="fl">0.0183156388887</span>]]</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The scenario manager has to be registered as follows:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>bptk.register_scenario_manager(scenario_manager)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After registering the scenario mangager, we can define and register more scenarios. Let us change <code>foodAvailable</code> from 80,000,000 units to 700,000 units.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bptk.register_scenarios(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    scenarios <span class="op">=</span>{</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"scenario07"</span>: {</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"constants"</span>: {</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"foodAvailable"</span>: <span class="fl">70000000.0</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    scenario_manager<span class="op">=</span><span class="st">"smPopulation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can plot our scenarios <code>base</code> and <code>scenario07</code> and see how changing <code>foodAvailable</code> affects the population. We plot the <code>population</code> for both scenarios.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>bptk.plot_scenarios(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    scenarios<span class="op">=</span>[<span class="st">"base"</span>,<span class="st">"scenario07"</span>],</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    scenario_managers<span class="op">=</span><span class="st">"smPopulation"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    equations<span class="op">=</span>[<span class="st">"population"</span>],</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    series_names<span class="op">=</span>{}</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'foodAvailable': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769310&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769700&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7698B0&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7699D0&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769A60&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769B80&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769CA0&gt;}
{'foodAvailable': &lt;function SdSimulation.change_equation.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E814040&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88E160&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88EE50&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88EF70&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE0D0&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE1F0&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE310&gt;}</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-23-output-2.png" width="1631" height="812"></p>
</div>
</div>
<p>According to the stock and flow diagram <code>foodAvailable</code> influences <code>foodAvailablePerPerson</code>. The less food we have, the less food one person has. <code>foodAvailablePerPerson</code> then affects the births and deaths. Less people are born and more people die because we don’t have enough food for each person. As a result, the population of <code>scenario07</code> decreases.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>bptk.plot_scenarios(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    scenarios<span class="op">=</span>[<span class="st">"base"</span>,<span class="st">"scenario07"</span>],</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    scenario_managers<span class="op">=</span><span class="st">"smPopulation"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    equations<span class="op">=</span>[<span class="st">"deathRate"</span>],</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    series_names<span class="op">=</span>{}</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'foodAvailable': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769310&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769700&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7698B0&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7699D0&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769A60&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769B80&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769CA0&gt;}
{'foodAvailable': &lt;function SdSimulation.change_equation.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7FAEE0&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88E160&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88EE50&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88EF70&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE0D0&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE1F0&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE310&gt;}</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="introduction_sd_dsl_files/figure-html/cell-24-output-2.png" width="1561" height="812"></p>
</div>
</div>
</section>
<section id="export-data-as-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="export-data-as-dataframe">Export data as “DataFrame”</h2>
<p>We built BPTK-Py with integration in mind. This means, you can easily export the simulation results as so-called “DataFrames”. This is a standard Python exchange format for data. This means you can easily process the simulation results in other data analysis / data science packages for further processing (Machine Learning, Data enrichment and many more). Just add the argument <code>return_df=True</code> to the plot_scenarios call:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>bptk.plot_scenarios(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    scenarios<span class="op">=</span>[<span class="st">"base"</span>,<span class="st">"scenario07"</span>],</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    scenario_managers<span class="op">=</span><span class="st">"smPopulation"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    equations<span class="op">=</span>[<span class="st">"population"</span>], </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    series_names<span class="op">=</span>{},</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    return_df<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'foodAvailable': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769310&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769700&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7698B0&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E7699D0&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769A60&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769B80&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E769CA0&gt;}
{'foodAvailable': &lt;function SdSimulation.change_equation.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E6C2F70&gt;, 'birthRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88E160&gt;, 'deathRate': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88EE50&gt;, 'foodAvailablePerPerson': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E88EF70&gt;, 'births': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE0D0&gt;, 'deaths': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE1F0&gt;, 'population': &lt;function Element.generate_function.&lt;locals&gt;.&lt;lambda&gt; at 0x000001D92E8AE310&gt;}</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>smPopulation_base_population</th>
      <th>smPopulation_scenario07_population</th>
    </tr>
    <tr>
      <th>t</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>80000000.0</td>
      <td>8.000000e+07</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>80000000.0</td>
      <td>7.838476e+07</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>80000000.0</td>
      <td>7.703903e+07</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>80000000.0</td>
      <td>7.591279e+07</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>80000000.0</td>
      <td>7.496674e+07</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>80000000.0</td>
      <td>7.417206e+07</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>80000000.0</td>
      <td>7.350453e+07</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>80000000.0</td>
      <td>7.294381e+07</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>80000000.0</td>
      <td>7.247280e+07</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>80000000.0</td>
      <td>7.207715e+07</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Thanks for working through this tutorial!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../sd-dsl/sddsl.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Introduction to SD DSL</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../sd-dsl/in-depth/in_depth_simple_python_library_sd_dsl/in_depth_simple_python_library_sd_dsl.html" class="pagination-link">
        <span class="nav-page-text">BPTK for System Dynamics</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">© Copyright 2022, transentis labs GmbH.</div>
  </div>
</footer>



</body></html>